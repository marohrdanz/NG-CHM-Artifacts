(function(){function v(a){if("undefined"===typeof a||!a.classList.contains("disabled")){var d=p.getHeatMap().getMapInformation().name;a=document.getElementById("column_dendro_canvas");var c=document.getElementById("row_dendro_canvas"),b=document.createElement("a"),h=new Image,m=new Image,k=new Image;t(a,200,50,b,function(g){h.onload=function(){t(c,50,200,b,function(l){m.onload=function(){t(u.canvas,200,200,b,function(e){k.onload=function(){D(h,m,k,200,200,b,function(f){b.setAttribute("href",f.toDataURL("image/png"));
b.setAttribute("download",d+"_tn.png");document.body.appendChild(b);b.click();b.remove()})};k.src=e.toDataURL("image/png")})};m.src=l.toDataURL("image/png")})};h.src=g.toDataURL("image/png")})}}function D(a,d,c,b,h,m,k){var g=document.createElement("canvas"),l=g.getContext("2d");l.imageSmoothingEnabled=!1;var e=p.getHeatMap(),f=e.getRowDendroConfig().show;e=e.getColDendroConfig().show;e="NONE"===e||"NA"===e?!1:!0;f="NONE"===f||"NA"===f?!1:!0;var w=b,x=h,q=!1===e?0:h/4,r=!1===f?0:b/4;g.width=b+r;g.height=
h+q;var y=0,z=0;!0===e?(l.drawImage(a,r,0,b,q),z=q):x+=q;!0===f?(l.drawImage(d,0,q,r,h),y=r):w+=r;l.drawImage(c,y,z,w,x);k(g,m)}function t(a,d,c,b,h){var m=new Image;a=a.toDataURL("image/png");10>a.length?UHM.systemMessage("Download Thumbnail Warning","The Summary Pane must be open and visible in the NG-CHM Viewer in order to download a thumbnail image of the heat map."):(m.onload=function(){var k=document.createElement("canvas"),g=k.getContext("2d");g.imageSmoothingQuality="high";g.mozImageSmoothingEnabled=
!1;g.imageSmoothingEnabled=!1;k.width=2*d;k.height=2*c;g.drawImage(m,0,0,2*d,2*c);var l=new Image;l.onload=function(){var e=document.createElement("canvas"),f=e.getContext("2d");f.imageSmoothingQuality="high";f.mozImageSmoothingEnabled=!1;f.imageSmoothingEnabled=!1;e.width=d;e.height=c;f.drawImage(l,0,0,d,c);h(e,b)};l.src=k.toDataURL("image/png")},m.src=a)}NgChm.markFile();const C={downloadSummaryPng:v,downloadSummaryMapPng:function(){var a=p.getHeatMap().getMapInformation().name,d=u.canvas.toDataURL("image/png"),
c=document.createElement("a");t(d,200,200,c,function(b){c.setAttribute("href",b.toDataURL("image/png"));c.setAttribute("download",a+"_tnMap.png");document.body.appendChild(c);c.click();c.remove()})},editWidget:function(a){a=a||[];-1!==a.indexOf("noheader")&&document.getElementById("mdaServiceHeader").classList.add("hide");-1!==a.indexOf("nopanelheaders")&&(A.showPaneHeader=!1);-1!==a.indexOf("nodetailview")&&(n.showDetailPane=!1,document.getElementById("summary_box_canvas").classList.add("hide"));
-1!==a.indexOf("showSummaryCovariateLabels")&&(u.flagDrawClassBarLabels=!0);-1!==a.indexOf("noBuilderUploads")&&(E.enableBuilderUploads=!1);-1!==a.indexOf("requireFocus")&&n.setKeyData("require-focus",!0)},hideEmbed:function(a){var d=window.frameElement;d.className="ngchmThumbnail";var c=document.getElementById("NGCHMEmbedWrapper"),b=document.getElementById("NGCHMEmbed");"undefined"===typeof a?(d.style.height=n.embedThumbHeight,c.style.height=n.embedThumbHeight,b.style.height=n.embedThumbHeight):
(d.style=a,c.style=a,b.style=a);a=document.getElementById("NGCHMEmbedCollapse");b.style.display="none";a.style.display="none";c.style.display=""},loadAllTilesTimer:function(){var a=p.getHeatMap();a=a.getNumRows(B.DETAIL_LEVEL)+a.getNumColumns(B.DETAIL_LEVEL);return 1E3>=a?500:2E3>=a?1E3:3E3>=a?2E3:4E3>=a?3E3:5E3>=a?4E3:6E3>=a?5E3:1E4},heatMapLoaded:function(){return null!==p.getHeatMap()},getSummaryHist:function(a){const d=p.getHeatMap();return d.getSummaryHist(d.getCurrentDL(),+a[0],+a[a.length-
1])},getLinkoutTypes:function(){return new Promise(a=>{NgChm.CUST.waitForPlugins(()=>{a(NgChm.CUST.linkoutTypes.slice(0))})})}};NgChm.createNS("NgChm.API",C);const n=NgChm.importNS("NgChm.UTIL"),B=NgChm.importNS("NgChm.MAPREP"),p=NgChm.importNS("NgChm.MMGR"),u=NgChm.importNS("NgChm.SUM"),A=NgChm.importNS("NgChm.Pane");NgChm.importNS("NgChm.DEV");const F=NgChm.importNS("NgChm.PDF"),E=NgChm.importNS("NgChm.LNK");NgChm.exportToNS("NgChm.API",{b64toBlob:n.b64toBlob,jsPDF:(...a)=>jspdf.jsPDF.apply(null,
a),generatePDF:F.openPdfPrefs,chmResize:()=>A.resizeNGCHM()});Object.assign(n,C);document.getElementById("menuPng").onclick=function(a){v(a.target)}})();
NgChm.importNS("NgChm.UI-Manager").onLoadCHM();
